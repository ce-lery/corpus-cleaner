<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Corpus Cleaner: /home/corpus-cleaner/corpus_cleaner/corpus_cleaner.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Corpus Cleaner
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_e31d1a3386dece3ee12ba483585e8ebd.html">corpus_cleaner</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">corpus_cleaner.hpp</div></div>
</div><!--header-->
<div class="contents">
<a href="corpus__cleaner_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &lt;bits/stdc++.h&gt;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#include &quot;<a class="code" href="language__filter_8hpp.html">language_filter.hpp</a>&quot;</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="preprocessor">#include &quot;<a class="code" href="perplexity__filter_8hh.html">perplexity_filter.hh</a>&quot;</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &quot;<a class="code" href="minhash_8hpp.html">minhash.hpp</a>&quot;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="keyword">using namespace </span>std;</div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="keyword">namespace </span>fs = filesystem;</div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"></span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">/**</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> * @brief   Structure for storing statistical information for each process of CorpusCleaner</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> * @details </span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> *      Each process of CorpusCleaner obtains the following specific information.</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> *       - text: one sentence of corpus</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> *       - id: text identification</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> *       - is_rejected: True if this text is eligible for deletion</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> *       - metadata: tags added during the filtering process</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> *       - language: Language determined by LanguageFilter </span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> *       - language_score: Language score calculated by LanguageFilter</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"> *       - perplexity: perplexity calculated by PerplexityFilter</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment"> *       These will be used later for drawing processing, etc.</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"> * @note    </span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">**/</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="struct__DOCUMENT.html">   23</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="struct__DOCUMENT.html">_DOCUMENT</a> {</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="struct__DOCUMENT.html#a05e506c9d3345f1a86cf1b67ddfcc8eb">   24</a></span>    <span class="keywordtype">string</span> <a class="code hl_variable" href="struct__DOCUMENT.html#a05e506c9d3345f1a86cf1b67ddfcc8eb">text</a>=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="struct__DOCUMENT.html#afc46ec59799c48a24a375af19e1eeafe">   25</a></span>    <span class="keywordtype">string</span> <span class="keywordtype">id</span>=<span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="struct__DOCUMENT.html#a32c54b3f132a6db4566436ada8c27d72">   26</a></span>    <span class="keywordtype">bool</span> <a class="code hl_variable" href="struct__DOCUMENT.html#a32c54b3f132a6db4566436ada8c27d72">is_rejected</a>=<span class="keyword">false</span>;</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="struct__DOCUMENT.html#aa5805273ad6e9b46827c5b444e090486">   27</a></span>    set&lt;string&gt; <a class="code hl_variable" href="struct__DOCUMENT.html#aa5805273ad6e9b46827c5b444e090486">metadata</a>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno"><a class="line" href="struct__DOCUMENT.html#a6b50ce5ef8e8f4d553e679b321e427a6">   28</a></span>    <span class="keywordtype">string</span> <a class="code hl_variable" href="struct__DOCUMENT.html#a6b50ce5ef8e8f4d553e679b321e427a6">language</a>;</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno"><a class="line" href="struct__DOCUMENT.html#a7acba21c02f7cbab2ce8dd2f5328573b">   29</a></span>    <span class="keywordtype">float</span> <a class="code hl_variable" href="struct__DOCUMENT.html#a7acba21c02f7cbab2ce8dd2f5328573b">language_score</a>=0;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno"><a class="line" href="struct__DOCUMENT.html#ae20340e56ae52a8a15388b29db52e5d0">   30</a></span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="struct__DOCUMENT.html#ae20340e56ae52a8a15388b29db52e5d0">perplexity</a>=999999;</div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="corpus__cleaner_8hpp.html#a5d89cc87d64387ec409dcb14d99d913f">   31</a></span>} <a class="code hl_typedef" href="corpus__cleaner_8hpp.html#a5d89cc87d64387ec409dcb14d99d913f">Document</a>;</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="comment"></span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="comment">/**</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="comment"> * @brief   Structure for storing statistical information for each process of CorpusCleaner</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment"> * @details </span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment"> *      Each process of CorpusCleaner obtains the following statistical information.</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment"> *       1. CopusCleaner processing name</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment"> *       2. Processed file name</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment"> *       3. Elapsed processing time</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment"> *       4. File size after processing</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="comment"> *</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="comment"> *       These will be used later for drawing processing, etc.</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment"> * @note    </span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="comment">**/</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno"><a class="line" href="struct__STATS.html">   46</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="struct__STATS.html">_STATS</a> {</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno"><a class="line" href="struct__STATS.html#adeae47f9c0ae764aeb7356ce08c30291">   47</a></span>    <span class="keywordtype">string</span> <a class="code hl_variable" href="struct__STATS.html#adeae47f9c0ae764aeb7356ce08c30291">process_name</a>;</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno"><a class="line" href="struct__STATS.html#ab362751dd3abaaa281b27cba16568948">   48</a></span>    <span class="keywordtype">string</span> <a class="code hl_variable" href="struct__STATS.html#ab362751dd3abaaa281b27cba16568948">file_name</a>;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno"><a class="line" href="struct__STATS.html#aa494c5f7d0a7397ced82b40432e03727">   49</a></span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="struct__STATS.html#aa494c5f7d0a7397ced82b40432e03727">elapsed_time</a>;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="struct__STATS.html#ac0790e8709e9cee59bec2b6e99d6f5e3">   50</a></span>    uint32_t <a class="code hl_variable" href="struct__STATS.html#ac0790e8709e9cee59bec2b6e99d6f5e3">result_file_size</a>;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="corpus__cleaner_8hpp.html#addf172c6a4ad6605da0672a1a5dc32f4">   51</a></span>} <a class="code hl_typedef" href="corpus__cleaner_8hpp.html#addf172c6a4ad6605da0672a1a5dc32f4">Stats</a>;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="keywordtype">void</span> <a class="code hl_function" href="corpus__cleaner_8hpp.html#a4a02a4a113b25c9e2789fc2a655f7b2a">ConvertTextToDocument</a>(<span class="keywordtype">string</span> sentence, </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>                           <span class="keywordtype">string</span> filename, </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>                           <span class="keywordtype">string</span> file_line_count,</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>                           <a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="keywordtype">void</span> <a class="code hl_function" href="corpus__cleaner_8hpp.html#a1ab81c8667edbbb5db38d5ec222ad529">ConvertInputFilesToJsonl</a>(<span class="keywordtype">string</span> input_folder_path,<span class="keywordtype">string</span> output_folder_path);</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="keywordtype">void</span> <a class="code hl_function" href="corpus__cleaner_8hpp.html#a059accc4b4a63a7175b93a3932da3e5a">ReadDocumentFromJsonlOneLine</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document,<span class="keywordtype">string</span> input_jsonl_line);</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="keywordtype">void</span> <a class="code hl_function" href="corpus__cleaner_8hpp.html#a94b5fbd266184c4ae25e7fc4a9cec18d">WriteDocumentToJsonl</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document,<span class="keywordtype">string</span> output_file_path);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><a class="code hl_struct" href="struct__STATS.html">Stats</a> <a class="code hl_function" href="corpus__cleaner_8hpp.html#ab7cd8eb1f3b37be5756d42e2dbc88030">MakeStats</a>(<span class="keywordtype">string</span> process_name,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>                <span class="keywordtype">string</span> output_path,</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>                <span class="keywordtype">double</span> elapsed_time);</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="keywordtype">void</span> <a class="code hl_function" href="corpus__cleaner_8hpp.html#a53e35a337d8299e4c28e3120f85829db">OutputStats</a>(<a class="code hl_struct" href="struct__STATS.html">Stats</a> stats);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno"><a class="line" href="classCorpusCleaner.html">   64</a></span><span class="keyword">class </span><a class="code hl_class" href="classCorpusCleaner.html">CorpusCleaner</a></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>{</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment">    /***member value***/</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="keywordtype">string</span> input_path;</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="keywordtype">string</span> intermediate_path;</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="keywordtype">string</span> output_path;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <span class="keywordtype">string</span> rejected_path;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <span class="keywordtype">string</span> exception_path;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    uint32_t min_length=5;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    uint32_t max_length=1000;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    set&lt;string&gt; accept_language{<span class="stringliteral">&quot;__label__ja&quot;</span>};</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="keywordtype">bool</span> sentence_segment=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    <span class="keywordtype">bool</span> store_rejected=<span class="keyword">true</span>;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    <span class="keywordtype">float</span> language_threshold=0.3;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="keywordtype">double</span> perplexity_threshold=999999;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <a class="code hl_class" href="classfasttext_1_1FastTextEx.html">fasttext::FastTextEx</a> language_filter;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <a class="code hl_class" href="classKenLMFilter.html">KenLMFilter</a> kenlm_filter;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="comment">//TODO: add vecter of result&#39;s file size of each cleaning process. At the end, analysys it.</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <a class="code hl_class" href="classGenerateDedupLSH.html">GenerateDedupLSH</a> *generate_dedup_lsh;  </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <a class="code hl_class" href="classLSHDeduplicator.html">LSHDeduplicator</a> *deduplicator; </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span> </div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span><span class="comment">    /***constructor***/</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <a class="code hl_function" href="classCorpusCleaner.html#a1a7f3a686665feb24f2b2e0f82924250">CorpusCleaner</a>(<span class="keywordtype">string</span> input_path,</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                  <span class="keywordtype">string</span> output_path,</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>                  uint32_t min_length,</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>                  uint32_t max_length,</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>                  set&lt;string&gt; accept_language,</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>                  <span class="keywordtype">bool</span> store_rejected,</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>                  <span class="keywordtype">bool</span> sentence_segment,</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>                  <span class="keywordtype">float</span> language_threshold,</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>                  <span class="keywordtype">double</span> perplexity_threshold,</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>                  <a class="code hl_class" href="classGenerateDedupLSH.html">GenerateDedupLSH</a> *generate_dedup_lsh,</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>                  <a class="code hl_class" href="classLSHDeduplicator.html">LSHDeduplicator</a> *deduplicator);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span><span class="comment">    /***destructor***/</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <a class="code hl_function" href="classCorpusCleaner.html#a5c1acbee2fc2921d1971ae980243991c">~CorpusCleaner</a>();</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span><span class="comment">    /***member function***/</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#a028fdb141f2b92da54429677f0abb154">Normalizer</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#afb2e7e32b845c6d937a6ba39aedbb3ef">URLRemover</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#a2d6691988972f9b7f5449cadf5f91c46">SpecialCharacterRemover</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#a945760c19bee2920cc4410b39d063d9c">EmojiRemover</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#abd164a42b1d01048b447557bebf440b0">QuotesRemover</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#a2ad1c81f4ad73d6c3b4325655c4daf28">LengthFilter</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#a72054e52aa4d162a33b7069483a6f6be">LanguageFilter</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#a45f781beefb1ccda6eee48daeee198af">PerplexityFilter</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#a48075612da853cba90b97e11c92b7c50">MinhashDeduplication</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#a4530fb07ae3f70e22100661e11cbb95f">ZeroPunctuationFilter</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#af0a2d8353ccd8b00b204d54672a0f5f7">SentenceSegmenter</a>(<span class="keywordtype">string</span> input_folder_path,<span class="keywordtype">string</span> output_folder_path);</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <a class="code hl_struct" href="struct__STATS.html">Stats</a> <a class="code hl_function" href="classCorpusCleaner.html#a6a0f8fc79938f7db32e5f7b37dbca94a">PipelineStep</a>(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;document, <span class="keywordtype">void</span> (<a class="code hl_class" href="classCorpusCleaner.html">CorpusCleaner</a>::*cleaner)(<a class="code hl_struct" href="struct__DOCUMENT.html">Document</a> &amp;));</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    int32_t <a class="code hl_function" href="classCorpusCleaner.html#a53c08cd06810612e46afd2b55f845578">CleanPipeline</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    <span class="keywordtype">void</span> <a class="code hl_function" href="classCorpusCleaner.html#abc9a8507a6fcc4db0a5287872c72bb47">StoreException</a>(<span class="keywordtype">string</span> function_name, <span class="keywordtype">string</span> reference);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>};</div>
<div class="ttc" id="aclassCorpusCleaner_html"><div class="ttname"><a href="classCorpusCleaner.html">CorpusCleaner</a></div><div class="ttdef"><b>Definition</b> <a href="#l00064">corpus_cleaner.hpp:65</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a028fdb141f2b92da54429677f0abb154"><div class="ttname"><a href="classCorpusCleaner.html#a028fdb141f2b92da54429677f0abb154">CorpusCleaner::Normalizer</a></div><div class="ttdeci">void Normalizer(Document &amp;document)</div><div class="ttdoc">Neologd Normalize sentence.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00540">corpus_cleaner.cpp:540</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a1a7f3a686665feb24f2b2e0f82924250"><div class="ttname"><a href="classCorpusCleaner.html#a1a7f3a686665feb24f2b2e0f82924250">CorpusCleaner::CorpusCleaner</a></div><div class="ttdeci">CorpusCleaner(string input_path, string output_path, uint32_t min_length, uint32_t max_length, set&lt; string &gt; accept_language, bool store_rejected, bool sentence_segment, float language_threshold, double perplexity_threshold, GenerateDedupLSH *generate_dedup_lsh, LSHDeduplicator *deduplicator)</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00239">corpus_cleaner.cpp:239</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a2ad1c81f4ad73d6c3b4325655c4daf28"><div class="ttname"><a href="classCorpusCleaner.html#a2ad1c81f4ad73d6c3b4325655c4daf28">CorpusCleaner::LengthFilter</a></div><div class="ttdeci">void LengthFilter(Document &amp;document)</div><div class="ttdoc">Remove too long sentence and too short sentence.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00309">corpus_cleaner.cpp:309</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a2d6691988972f9b7f5449cadf5f91c46"><div class="ttname"><a href="classCorpusCleaner.html#a2d6691988972f9b7f5449cadf5f91c46">CorpusCleaner::SpecialCharacterRemover</a></div><div class="ttdeci">void SpecialCharacterRemover(Document &amp;document)</div><div class="ttdoc">Remove special character. For example, ☀, ♡, ☆, and so on.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00435">corpus_cleaner.cpp:435</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a4530fb07ae3f70e22100661e11cbb95f"><div class="ttname"><a href="classCorpusCleaner.html#a4530fb07ae3f70e22100661e11cbb95f">CorpusCleaner::ZeroPunctuationFilter</a></div><div class="ttdeci">void ZeroPunctuationFilter(Document &amp;document)</div><div class="ttdoc">Remove sentence without punctuation.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00512">corpus_cleaner.cpp:512</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a45f781beefb1ccda6eee48daeee198af"><div class="ttname"><a href="classCorpusCleaner.html#a45f781beefb1ccda6eee48daeee198af">CorpusCleaner::PerplexityFilter</a></div><div class="ttdeci">void PerplexityFilter(Document &amp;document)</div><div class="ttdoc">KenLM's Perplexity Quality filtering.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00331">corpus_cleaner.cpp:331</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a48075612da853cba90b97e11c92b7c50"><div class="ttname"><a href="classCorpusCleaner.html#a48075612da853cba90b97e11c92b7c50">CorpusCleaner::MinhashDeduplication</a></div><div class="ttdeci">void MinhashDeduplication(Document &amp;document)</div><div class="ttdoc">MinHashLSH Deduplication files in the this-&gt;intermediate folder.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00569">corpus_cleaner.cpp:569</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a53c08cd06810612e46afd2b55f845578"><div class="ttname"><a href="classCorpusCleaner.html#a53c08cd06810612e46afd2b55f845578">CorpusCleaner::CleanPipeline</a></div><div class="ttdeci">int32_t CleanPipeline(void)</div><div class="ttdoc">Pipeline that sequentially executes the configured CorpusCleaner methods.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00751">corpus_cleaner.cpp:751</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a5c1acbee2fc2921d1971ae980243991c"><div class="ttname"><a href="classCorpusCleaner.html#a5c1acbee2fc2921d1971ae980243991c">CorpusCleaner::~CorpusCleaner</a></div><div class="ttdeci">~CorpusCleaner()</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00290">corpus_cleaner.cpp:290</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a6a0f8fc79938f7db32e5f7b37dbca94a"><div class="ttname"><a href="classCorpusCleaner.html#a6a0f8fc79938f7db32e5f7b37dbca94a">CorpusCleaner::PipelineStep</a></div><div class="ttdeci">Stats PipelineStep(Document &amp;document, void(CorpusCleaner::*cleaner)(Document &amp;))</div><div class="ttdoc">PipelineStep.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00673">corpus_cleaner.cpp:673</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a72054e52aa4d162a33b7069483a6f6be"><div class="ttname"><a href="classCorpusCleaner.html#a72054e52aa4d162a33b7069483a6f6be">CorpusCleaner::LanguageFilter</a></div><div class="ttdeci">void LanguageFilter(Document &amp;document)</div><div class="ttdoc">Language filtering using fastText.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00365">corpus_cleaner.cpp:365</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_a945760c19bee2920cc4410b39d063d9c"><div class="ttname"><a href="classCorpusCleaner.html#a945760c19bee2920cc4410b39d063d9c">CorpusCleaner::EmojiRemover</a></div><div class="ttdeci">void EmojiRemover(Document &amp;document)</div><div class="ttdoc">Remove emoji. For example, 🤗, 🐉, 📊, and so on.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00467">corpus_cleaner.cpp:467</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_abc9a8507a6fcc4db0a5287872c72bb47"><div class="ttname"><a href="classCorpusCleaner.html#abc9a8507a6fcc4db0a5287872c72bb47">CorpusCleaner::StoreException</a></div><div class="ttdeci">void StoreException(string function_name, string reference)</div><div class="ttdoc">Save exception in file.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00227">corpus_cleaner.cpp:227</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_abd164a42b1d01048b447557bebf440b0"><div class="ttname"><a href="classCorpusCleaner.html#abd164a42b1d01048b447557bebf440b0">CorpusCleaner::QuotesRemover</a></div><div class="ttdeci">void QuotesRemover(Document &amp;document)</div><div class="ttdoc">Remove quotes. For example, [1], {245}, and so on.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00490">corpus_cleaner.cpp:490</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_af0a2d8353ccd8b00b204d54672a0f5f7"><div class="ttname"><a href="classCorpusCleaner.html#af0a2d8353ccd8b00b204d54672a0f5f7">CorpusCleaner::SentenceSegmenter</a></div><div class="ttdeci">void SentenceSegmenter(string input_folder_path, string output_folder_path)</div><div class="ttdoc">Simple sentence splitter for japanese text.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00617">corpus_cleaner.cpp:617</a></div></div>
<div class="ttc" id="aclassCorpusCleaner_html_afb2e7e32b845c6d937a6ba39aedbb3ef"><div class="ttname"><a href="classCorpusCleaner.html#afb2e7e32b845c6d937a6ba39aedbb3ef">CorpusCleaner::URLRemover</a></div><div class="ttdeci">void URLRemover(Document &amp;document)</div><div class="ttdoc">Remove URLs matching regular expression.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00407">corpus_cleaner.cpp:407</a></div></div>
<div class="ttc" id="aclassGenerateDedupLSH_html"><div class="ttname"><a href="classGenerateDedupLSH.html">GenerateDedupLSH</a></div><div class="ttdef"><b>Definition</b> <a href="minhash_8hpp_source.html#l00006">minhash.hpp:7</a></div></div>
<div class="ttc" id="aclassKenLMFilter_html"><div class="ttname"><a href="classKenLMFilter.html">KenLMFilter</a></div><div class="ttdef"><b>Definition</b> <a href="perplexity__filter_8hh_source.html#l00033">perplexity_filter.hh:34</a></div></div>
<div class="ttc" id="aclassLSHDeduplicator_html"><div class="ttname"><a href="classLSHDeduplicator.html">LSHDeduplicator</a></div><div class="ttdef"><b>Definition</b> <a href="minhash_8hpp_source.html#l00028">minhash.hpp:29</a></div></div>
<div class="ttc" id="aclassfasttext_1_1FastTextEx_html"><div class="ttname"><a href="classfasttext_1_1FastTextEx.html">fasttext::FastTextEx</a></div><div class="ttdef"><b>Definition</b> <a href="language__filter_8hpp_source.html#l00018">language_filter.hpp:19</a></div></div>
<div class="ttc" id="acorpus__cleaner_8hpp_html_a059accc4b4a63a7175b93a3932da3e5a"><div class="ttname"><a href="corpus__cleaner_8hpp.html#a059accc4b4a63a7175b93a3932da3e5a">ReadDocumentFromJsonlOneLine</a></div><div class="ttdeci">void ReadDocumentFromJsonlOneLine(Document &amp;document, string input_jsonl_line)</div><div class="ttdoc">Loggging Document to output_file_path.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00026">corpus_cleaner.cpp:26</a></div></div>
<div class="ttc" id="acorpus__cleaner_8hpp_html_a1ab81c8667edbbb5db38d5ec222ad529"><div class="ttname"><a href="corpus__cleaner_8hpp.html#a1ab81c8667edbbb5db38d5ec222ad529">ConvertInputFilesToJsonl</a></div><div class="ttdeci">void ConvertInputFilesToJsonl(string input_folder_path, string output_folder_path)</div><div class="ttdoc">Convert input files to jsonl that has Document's element.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00135">corpus_cleaner.cpp:135</a></div></div>
<div class="ttc" id="acorpus__cleaner_8hpp_html_a4a02a4a113b25c9e2789fc2a655f7b2a"><div class="ttname"><a href="corpus__cleaner_8hpp.html#a4a02a4a113b25c9e2789fc2a655f7b2a">ConvertTextToDocument</a></div><div class="ttdeci">void ConvertTextToDocument(string sentence, string filename, string file_line_count, Document &amp;document)</div><div class="ttdoc">Convert input files to jsonl that has Document's element.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00113">corpus_cleaner.cpp:113</a></div></div>
<div class="ttc" id="acorpus__cleaner_8hpp_html_a53e35a337d8299e4c28e3120f85829db"><div class="ttname"><a href="corpus__cleaner_8hpp.html#a53e35a337d8299e4c28e3120f85829db">OutputStats</a></div><div class="ttdeci">void OutputStats(Stats stats)</div><div class="ttdoc">Output statistics.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00210">corpus_cleaner.cpp:210</a></div></div>
<div class="ttc" id="acorpus__cleaner_8hpp_html_a5d89cc87d64387ec409dcb14d99d913f"><div class="ttname"><a href="corpus__cleaner_8hpp.html#a5d89cc87d64387ec409dcb14d99d913f">Document</a></div><div class="ttdeci">struct _DOCUMENT Document</div><div class="ttdoc">Structure for storing statistical information for each process of CorpusCleaner.</div></div>
<div class="ttc" id="acorpus__cleaner_8hpp_html_a94b5fbd266184c4ae25e7fc4a9cec18d"><div class="ttname"><a href="corpus__cleaner_8hpp.html#a94b5fbd266184c4ae25e7fc4a9cec18d">WriteDocumentToJsonl</a></div><div class="ttdeci">void WriteDocumentToJsonl(Document &amp;document, string output_file_path)</div><div class="ttdoc">Loggging Document to output_file_path.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00074">corpus_cleaner.cpp:74</a></div></div>
<div class="ttc" id="acorpus__cleaner_8hpp_html_ab7cd8eb1f3b37be5756d42e2dbc88030"><div class="ttname"><a href="corpus__cleaner_8hpp.html#ab7cd8eb1f3b37be5756d42e2dbc88030">MakeStats</a></div><div class="ttdeci">Stats MakeStats(string process_name, string output_path, double elapsed_time)</div><div class="ttdoc">Format statistics.</div><div class="ttdef"><b>Definition</b> <a href="corpus__cleaner_8cpp_source.html#l00186">corpus_cleaner.cpp:186</a></div></div>
<div class="ttc" id="acorpus__cleaner_8hpp_html_addf172c6a4ad6605da0672a1a5dc32f4"><div class="ttname"><a href="corpus__cleaner_8hpp.html#addf172c6a4ad6605da0672a1a5dc32f4">Stats</a></div><div class="ttdeci">struct _STATS Stats</div><div class="ttdoc">Structure for storing statistical information for each process of CorpusCleaner.</div></div>
<div class="ttc" id="alanguage__filter_8hpp_html"><div class="ttname"><a href="language__filter_8hpp.html">language_filter.hpp</a></div></div>
<div class="ttc" id="aminhash_8hpp_html"><div class="ttname"><a href="minhash_8hpp.html">minhash.hpp</a></div></div>
<div class="ttc" id="aperplexity__filter_8hh_html"><div class="ttname"><a href="perplexity__filter_8hh.html">perplexity_filter.hh</a></div></div>
<div class="ttc" id="astruct__DOCUMENT_html"><div class="ttname"><a href="struct__DOCUMENT.html">_DOCUMENT</a></div><div class="ttdoc">Structure for storing statistical information for each process of CorpusCleaner.</div><div class="ttdef"><b>Definition</b> <a href="#l00023">corpus_cleaner.hpp:23</a></div></div>
<div class="ttc" id="astruct__DOCUMENT_html_a05e506c9d3345f1a86cf1b67ddfcc8eb"><div class="ttname"><a href="struct__DOCUMENT.html#a05e506c9d3345f1a86cf1b67ddfcc8eb">_DOCUMENT::text</a></div><div class="ttdeci">string text</div><div class="ttdef"><b>Definition</b> <a href="#l00024">corpus_cleaner.hpp:24</a></div></div>
<div class="ttc" id="astruct__DOCUMENT_html_a32c54b3f132a6db4566436ada8c27d72"><div class="ttname"><a href="struct__DOCUMENT.html#a32c54b3f132a6db4566436ada8c27d72">_DOCUMENT::is_rejected</a></div><div class="ttdeci">bool is_rejected</div><div class="ttdef"><b>Definition</b> <a href="#l00026">corpus_cleaner.hpp:26</a></div></div>
<div class="ttc" id="astruct__DOCUMENT_html_a6b50ce5ef8e8f4d553e679b321e427a6"><div class="ttname"><a href="struct__DOCUMENT.html#a6b50ce5ef8e8f4d553e679b321e427a6">_DOCUMENT::language</a></div><div class="ttdeci">string language</div><div class="ttdef"><b>Definition</b> <a href="#l00028">corpus_cleaner.hpp:28</a></div></div>
<div class="ttc" id="astruct__DOCUMENT_html_a7acba21c02f7cbab2ce8dd2f5328573b"><div class="ttname"><a href="struct__DOCUMENT.html#a7acba21c02f7cbab2ce8dd2f5328573b">_DOCUMENT::language_score</a></div><div class="ttdeci">float language_score</div><div class="ttdef"><b>Definition</b> <a href="#l00029">corpus_cleaner.hpp:29</a></div></div>
<div class="ttc" id="astruct__DOCUMENT_html_aa5805273ad6e9b46827c5b444e090486"><div class="ttname"><a href="struct__DOCUMENT.html#aa5805273ad6e9b46827c5b444e090486">_DOCUMENT::metadata</a></div><div class="ttdeci">set&lt; string &gt; metadata</div><div class="ttdef"><b>Definition</b> <a href="#l00027">corpus_cleaner.hpp:27</a></div></div>
<div class="ttc" id="astruct__DOCUMENT_html_ae20340e56ae52a8a15388b29db52e5d0"><div class="ttname"><a href="struct__DOCUMENT.html#ae20340e56ae52a8a15388b29db52e5d0">_DOCUMENT::perplexity</a></div><div class="ttdeci">double perplexity</div><div class="ttdef"><b>Definition</b> <a href="#l00030">corpus_cleaner.hpp:30</a></div></div>
<div class="ttc" id="astruct__STATS_html"><div class="ttname"><a href="struct__STATS.html">_STATS</a></div><div class="ttdoc">Structure for storing statistical information for each process of CorpusCleaner.</div><div class="ttdef"><b>Definition</b> <a href="#l00046">corpus_cleaner.hpp:46</a></div></div>
<div class="ttc" id="astruct__STATS_html_aa494c5f7d0a7397ced82b40432e03727"><div class="ttname"><a href="struct__STATS.html#aa494c5f7d0a7397ced82b40432e03727">_STATS::elapsed_time</a></div><div class="ttdeci">double elapsed_time</div><div class="ttdef"><b>Definition</b> <a href="#l00049">corpus_cleaner.hpp:49</a></div></div>
<div class="ttc" id="astruct__STATS_html_ab362751dd3abaaa281b27cba16568948"><div class="ttname"><a href="struct__STATS.html#ab362751dd3abaaa281b27cba16568948">_STATS::file_name</a></div><div class="ttdeci">string file_name</div><div class="ttdef"><b>Definition</b> <a href="#l00048">corpus_cleaner.hpp:48</a></div></div>
<div class="ttc" id="astruct__STATS_html_ac0790e8709e9cee59bec2b6e99d6f5e3"><div class="ttname"><a href="struct__STATS.html#ac0790e8709e9cee59bec2b6e99d6f5e3">_STATS::result_file_size</a></div><div class="ttdeci">uint32_t result_file_size</div><div class="ttdef"><b>Definition</b> <a href="#l00050">corpus_cleaner.hpp:50</a></div></div>
<div class="ttc" id="astruct__STATS_html_adeae47f9c0ae764aeb7356ce08c30291"><div class="ttname"><a href="struct__STATS.html#adeae47f9c0ae764aeb7356ce08c30291">_STATS::process_name</a></div><div class="ttdeci">string process_name</div><div class="ttdef"><b>Definition</b> <a href="#l00047">corpus_cleaner.hpp:47</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
